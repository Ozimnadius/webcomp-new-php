//@prepros-append pages/common.js
//@prepros-append pages/index.js
//@prepros-append pages/site.js
//@prepros-append pages/promote.js
//@prepros-append pages/seo.js
//@prepros-append pages/smm.js
//@prepros-append pages/theme.js
//@prepros-append pages/reklama.js
//@prepros-append pages/portfolio.js
//@prepros-append pages/articles.js
//@prepros-append pages/map.js
//@prepros-append pages/test.js
//@prepros-append pages/aside.js
//@prepros-append pages/popup.js
//@prepros-append pages/validation.js
//@prepros-append pages/timer.js
//@prepros-append pages/banner-send.js
//@prepros-append pages/swiper.js







$.fn.hyphenate = function () {
    var all = "[абвгдеёжзийклмнопрстуфхцчшщъыьэюя]",
        glas = "[аеёиоуыэю\я]",
        sogl = "[бвгджзклмнпрстфхцчшщ]",
        zn = "[йъь]",
        shy = "\xAD",
        re = [];

    re[1] = new RegExp("(" + zn + ")(" + all + all + ")", "ig");
    re[2] = new RegExp("(" + glas + ")(" + glas + all + ")", "ig");
    re[3] = new RegExp("(" + glas + sogl + ")(" + sogl + glas + ")", "ig");
    re[4] = new RegExp("(" + sogl + glas + ")(" + sogl + glas + ")", "ig");
    re[5] = new RegExp("(" + glas + sogl + ")(" + sogl + sogl + glas + ")", "ig");
    re[6] = new RegExp("(" + glas + sogl + sogl + ")(" + sogl + sogl + glas + ")", "ig");
    return this.each(function () {
        var text = $(this).html();
        for (var i = 1; i < 7; ++i) {
            text = text.replace(re[i], "$1" + shy + "$2");
        }
        $(this).html(text);
    });
};

function getComputedTranslateY(obj) {
    if (!window.getComputedStyle) return;
    var style = getComputedStyle(obj),
        transform = style.transform || style.webkitTransform || style.mozTransform;
    var mat = transform.match(/^matrix3d\((.+)\)$/);
    if (mat) return parseFloat(mat[1].split(', ')[13]);
    mat = transform.match(/^matrix\((.+)\)$/);
    return mat ? parseFloat(mat[1].split(', ')[5]) : 0;
}

function getCssValuePrefix() {
    var rtrnVal = '';//default to standard syntax
    var prefixes = ['-o-', '-ms-', '-moz-', '-webkit-'];

    // Create a temporary DOM object for testing
    var dom = document.createElement('div');

    for (var i = 0; i < prefixes.length; i++) {
        // Attempt to set the style
        dom.style.background = prefixes[i] + 'linear-gradient(#000000, #ffffff)';

        // Detect if the style was successfully set
        if (dom.style.background) {
            rtrnVal = prefixes[i];
        }
    }

    dom = null;
    delete dom;

    return rtrnVal;
}

function GetNoun(number, one, two, five) {
    number = Math.abs(number);
    number %= 100;
    if (number >= 5 && number <= 20) {
        return five;
    }
    number %= 10;
    if (number == 1) {
        return one;
    }
    if (number >= 2 && number <= 4) {
        return two;
    }
    return five;
}

function index(list, item) {
    return Array.prototype.indexOf.call(list, item);
}

function Switches(prop) {
    this.sws = document.querySelector(prop.sws);
    this.width = this.sws.offsetWidth;
    this.swsList = document.querySelectorAll(prop.sw);
    this.line = document.querySelector(prop.line);
    this.tabs = document.querySelectorAll(prop.tab);
    this.tabSelector = prop.tab;
    this.autoWidth = prop.autoWidth || false;
    // this.scrollbar = prop.scrollbar || true;

    if (prop.switchActive === false) {
        this.switchActive = false
    } else {
        this.switchActive = true;
    }

    if (prop.scrollbar === false) {
        this.scrollbar = false;
    } else {
        this.scrollbar = true;
    }

    let that = this;

    for (let i = 0; i < that.swsList.length; i++) {
        that.swsList[i].addEventListener('click', function (e) {

            let percent = (this.offsetLeft / that.width) * 100,
                id = this.dataset.id,
                tab = document.querySelector(that.tabSelector + '[data-id="' + id + '"]');


            for (let i = 0; i < that.swsList.length; i++) {
                that.swsList[i].classList.remove('active');
            }

            for (let i = 0; i < that.tabs.length; i++) {
                that.tabs[i].classList.remove('active');
            }

            tab.classList.add('active');
            this.classList.add('active');

            if (that.scrollbar) {
                that.line.style.left = percent + '%';

                if (that.autoWidth) {
                    let lineWidth = this.offsetWidth + 'px';
                    that.line.style.width = lineWidth;
                }
            }

        });
    }
}


let isScrolling = false;
window.addEventListener('scroll', throttleScroll, false);

function throttleScroll(e) {
    if (isScrolling == false) {
        window.requestAnimationFrame(function () {
            scrolling(e);
            isScrolling = false;
        });
    }
    isScrolling = true;
}

document.addEventListener("DOMContentLoaded", scrolling, false);

let numberAll = document.querySelectorAll('.number');

if (numberAll) {

    function scrolling(e) {

        for (let i = 0; i < numberAll.length; i++) {
            let number = numberAll[i],
                val = number.querySelector('.number__val'),
                from = parseInt(val.dataset.from),
                to = parseInt(val.dataset.to);

            if (number.classList.contains('active')) {
                continue;
            }

            if (isFullyVisible(number)) {
                number.classList.add('active');
                counting(val, from, to, 2000);
            }
        }

    }
}

function counting(val, from, to, time) {
    let i = from,
        frame = time / to;

    let numInterval = setInterval(function (e) {
        if (i <= to) {
            val.innerHTML = i;
            i++;
        } else {
            clearInterval(numInterval);
        }

    }, frame)

}

function isPartiallyVisible(el) {
    var elementBoundary = el.getBoundingClientRect();

    var top = elementBoundary.top;
    var bottom = elementBoundary.bottom;
    var height = elementBoundary.height;

    return ((top + height >= 0) && (height + window.innerHeight >= bottom));
}

function isFullyVisible(el) {
    var elementBoundary = el.getBoundingClientRect();

    var top = elementBoundary.top;
    var bottom = elementBoundary.bottom;

    return ((top >= 0) && (bottom <= window.innerHeight));
}

$('select').selectize();




(function () {

    // let canvas = document.querySelector('.smoke'),
    //     ctx = canvas.getContext('2d');
    // canvas.width = innerWidth;
    // canvas.height = innerHeight;
    //
    // let party = smokemachine(ctx, [131, 145, 206]);
    // party.start(); // start animating
    // party.setPreDrawCallback(function (dt) {
    //     party.addSmoke(innerWidth - 200, innerHeight + 400, .9);
    //     canvas.width = innerWidth;
    //     canvas.height = innerHeight;
    // });
    // onmousemove = function (e) {
    //     let x = e.clientX,
    //         y = e.clientY,
    //         n = .9,
    //         t = Math.floor(Math.random() * 200) + 7600;
    //     party.addsmoke(x, y, n, t)
    // }



    let pagItems = document.querySelector('.pag__items'),
        pagAllItem = document.querySelectorAll('.pag__item'),
        sections = document.querySelectorAll('section'),
        mainContent = document.querySelector('.main'),
        inScroll = false,
        figure = document.querySelector('.figure'),
        screen = 0,
        sectionBottom = document.querySelector('.index-bottom'),
        scrollTop = 0,
        page = document.querySelector('.page'),
        pagination = document.querySelector('.pag'),
        nextSectionBtn = document.querySelector('.nextSection'),
        historySection = localStorage.getItem('sectionIndex'),
        historyPage = localStorage.getItem('page');


    if (historySection && !page.classList.contains('page_second') && document.querySelector('.' + historyPage)) {
        scrollToSection(localStorage.getItem('sectionIndex'));
    }


    function scrollToSection(sectionIndex) {
        let position = sectionIndex * -100 + 'vh',
            section = sections[sectionIndex],
            translateY = (sectionIndex) * -102;

        for (let i = 0; i < pagAllItem.length; i++) {
            pagAllItem[i].classList.remove('active');
        }


        for (let i = 0; i < sections.length; i++) {
            sections[i].classList.remove('active-page');
        }

        if (pagItems) {
            pagAllItem[sectionIndex].classList.add('active');
            pagItems.style.transform = 'translate3d(0,' + translateY + 'px,0)';
        }

        section.classList.add('active-page');
        mainContent.style.transform = 'translate3d(0,' + position + ',0)';


        if (figure) {
            if (section.classList.contains('index-about')) {
                setTimeout(function () {
                    figure.classList.add('active');
                }, 1000);

            } else {
                figure.classList.remove('active');
            }
        }

        if (section.classList.contains('comp-rew')) {
            for (let i = 0; i < numberAll.length; i++) {
                let number = numberAll[i],
                    val = number.querySelector('.number__val'),
                    from = parseInt(val.dataset.from),
                    to = parseInt(val.dataset.to);

                if (number.classList.contains('active')) {
                    continue;
                }

                number.classList.add('active');
                counting(val, from, to, 2000);
            }
        }

        if (pagItems) {
            if (sectionIndex === 3) {
                document.querySelector('.pag__arrow-line').style.opacity = 0;
            } else {
                document.querySelector('.pag__arrow-line').style.opacity = 1;
            }

            if (section.classList.contains('index-bottom')) {
                pagination.classList.add('hidden');
            } else {
                pagination.classList.remove('hidden');
            }
        }

        localStorage.setItem('sectionIndex', sectionIndex);
        localStorage.setItem('page', mainContent.firstElementChild.className);

        setTimeout(function () {
            inScroll = false;
        }, 500);

    }

    if (!page.classList.contains('page_second')) {


        if (pagItems) {
            pagItems.addEventListener('click', function (e) {
                if (e.target.classList.contains('pag__item')) {
                    e.preventDefault();
                    scrollToSection(index(pagAllItem, e.target));
                }
            });
        }

        if (sections.length > 1) {
            document.addEventListener('wheel', function (e) {


                let deltaY = e.deltaY,
                    activeSection = document.querySelector('.active-page'),
                    nextSection = activeSection.nextElementSibling,
                    prevSection = activeSection.previousElementSibling;

                if (!activeSection.classList.contains('index-bottom')) {
                    e.preventDefault();
                } else {
                    if (deltaY > 0) {
                        return;
                    } else {
                        if (scrollTop > 0) {
                            return;
                        }
                    }

                }

                if (inScroll) return;

                inScroll = true;

                if (deltaY > 0) {
                    if (nextSection) {
                        scrollToSection(index(sections, nextSection));
                    } else {
                        inScroll = false;
                    }
                } else {
                    if (prevSection) {
                        scrollToSection(index(sections, prevSection));
                    } else {
                        inScroll = false;
                    }
                }

            });

            if (sectionBottom) {
                sectionBottom.addEventListener('scroll', function (e) {
                    scrollTop = this.scrollTop;
                });
            }
        }
    }

    if (nextSectionBtn) {
        nextSectionBtn.addEventListener('click', function (e) {
            let index = this.dataset.id;
            scrollToSection(index);
        })
    }

    $('.index-about__content').hyphenate();


    let range = document.querySelector('.calc__range');
    if (range) {
        range.addEventListener('input', function () {

            let rangeVal = document.querySelector('.calc__range-val'),
                rangeTitle = document.querySelector('.calc__range-text');

            rangeVal.innerHTML = this.value;
            rangeTitle.innerHTML = ' ' + GetNoun(this.value, 'месяц', 'месяца', 'месяцев');
            this.style.backgroundImage = getCssValuePrefix() + 'linear-gradient(left ,#ffba00 0%,#ffba00 ' + this.value + '%, #352b4d ' + this.value + '%, #352b4d 100%)';

        });
    }


    let switchButton = document.querySelector('.best__switch-button'),
        switches = document.querySelectorAll('.best__switch'),
        tabs = document.querySelectorAll('.best__tab');
    if (switchButton) {
        switchButton.addEventListener('click', function (e) {

            let nextSwitch = '';
            for (let i = 0; i < switches.length; i++) {
                if (!switches[i].classList.contains('active')) {
                    nextSwitch = switches[i];
                }
            }

            let id = nextSwitch.dataset.id,
                activeTab = document.querySelector('.best__tab[data-id="' + id + '"]');

            //Toggle switces
            for (let i = 0; i < switches.length; i++) {
                switches[i].classList.remove('active');
            }
            nextSwitch.classList.add('active');

            //Toggle tabs
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            activeTab.classList.add('active');

            //Toggle button
            this.classList.toggle('right');

        });

        for (let i = 0; i < switches.length; i++) {
            switches[i].addEventListener('click', function (e) {
                let id = this.dataset.id,
                    activeTab = document.querySelector('.best__tab[data-id="' + id + '"]');

                //Toggle switces
                for (let i = 0; i < switches.length; i++) {
                    switches[i].classList.remove('active');
                }
                this.classList.add('active');

                //Toggle tabs
                for (let i = 0; i < tabs.length; i++) {
                    tabs[i].classList.remove('active');
                }
                activeTab.classList.add('active');

                //Toggle button
                switchButton.classList.toggle('right');
            });
        }
    }


    let calcForm = document.querySelector('.calc');
    if (calcForm) {

    }

}());
(function () {
    let costSwithes = document.querySelector('.site-cost__switches-list');
    if (costSwithes) {

        let switches = new Switches({
            sws: '.site-cost__switches-list',
            sw: '.site-cost__switch',
            line: '.site-cost__subline',
            tab: '.site-cost__tab',
            switchActive: false
        });
    }

    let formNextAll = document.querySelectorAll('.site-cost .form__button');
    if (formNextAll) {
        for (let i=0; i<formNextAll.length; i++) {
            formNextAll[i].addEventListener('click', function (e) {
                document.querySelector('.site-cost__switch.active').nextElementSibling.click();
            });
        }

    }

}());
(function () {

    let promoteFormOpen= document.querySelector('.promote-first__button'),
        promoteFirst = document.querySelector('.promote-first__wrapper'),
        promoteCalc = document.querySelector('.promote-first__calc');
    if (promoteFormOpen) {
        promoteFormOpen.addEventListener('click', function (e) {
            promoteFirst.classList.add('disabled');
            promoteCalc.classList.add('active');
        });
    }
    let promoteFormClose = document.querySelector('.promote-calc__close')
    if (promoteFormClose) {
        promoteFormClose.addEventListener('click', function (e) {
            promoteFirst.classList.remove('disabled');
            promoteCalc.classList.remove('active');
        });
    }

}());
(function () {
    let costSwithes = document.querySelector('.seo-price__switches-list');
    if (costSwithes) {

        let switches = new Switches({
            sws: '.seo-price__switches-list',
            sw: '.seo-price__switch',
            line: '.seo-price__subline',
            tab: '.seo-price__tab',
            autoWidth: true
        });
    }

    let acco = document.querySelector('.seo-faq__acco'),
        accoItems = document.querySelectorAll('.seo-faq__item');

    if (acco) {
        acco.addEventListener('click', function (e) {
            let target = e.target;

            if (target.classList.contains('seo-faq__item-title')) {

                let item = target.parentNode,
                    itemWrap = item.querySelector('.seo-faq__item-wrap'),
                    itemContent = item.querySelector('.seo-faq__item-desc'),
                    height = itemContent.offsetHeight+'px';


                for (let i = 0; i < accoItems.length; i++) {
                    if (accoItems[i] != item) {
                        accoItems[i].querySelector('.seo-faq__item-wrap').style.height = '';
                    }
                }

                if (!itemWrap.style.height) {
                    itemWrap.style.height = height;
                } else {
                    itemWrap.style.height = '';
                }
            }

        });
    }
}());
(function () {
    let sws = document.querySelector('.smm-str__sws-list');
    if (sws) {

        let switches = new Switches({
            sws: '.smm-str__sws-list',
            sw: '.smm-str__sw',
            tab: '.smm-str__tab',
            scrollbar: false
        });
    }

    $('.scrollTo').on('click', function (e) {
        e.preventDefault();

        let form = $($(this).attr('href'));

        $('html, body').animate({
            scrollTop: form.offset().top
        }, 400);

    });

}());
(function () {
    let costSwithes = document.querySelector('.theme-price__switches-list');
    if (costSwithes) {

        let switches = new Switches({
            sws: '.theme-price__switches-list',
            sw: '.theme-price__switch',
            line: '.theme-price__subline',
            tab: '.theme-price__tab',
            autoWidth: true
        });
    }

}());
(function () {
    let costSwithes = document.querySelector('.rek-price__switches-list');
    if (costSwithes) {

        let switches = new Switches({
            sws: '.rek-price__switches-list',
            sw: '.rek-price__switch',
            line: '.rek-price__subline',
            tab: '.rek-price__tab',
            autoWidth: true
        });
    }

}());
(function () {
    let dragObject = {},
        item = document.querySelector('.port-lap__drug.draggable');

    if (item) {

        let width = document.querySelector('.port-lap__container').offsetWidth;

        item.onmousedown = function (e) {

            let elem = e.target.closest('.draggable');
            // запомнить переносимый объект
            dragObject.elem = elem;

            // запомнить координаты, с которых начат перенос объекта
            dragObject.downX = e.pageX;
        };

        document.onmousemove = function (e) {


            if (!dragObject.elem) return; // элемент не зажат

            // посчитать дистанцию, на которую переместился курсор мыши
            let moveX = e.pageX - dragObject.downX;
            dragObject.downX = e.pageX;

            if (Math.abs(moveX) < 3) {
                return; // ничего не делать, мышь не передвинулась достаточно далеко
            }

            let offsetLeft = dragObject.elem.offsetLeft + 31.15 + moveX;

            dragObject.avatar = document.querySelector('.port-lap__before'); // захватить элемент

            let percent = 100 - ((offsetLeft / width) * 100);
            if (percent < 0) return;

            console.log(percent);

            // отобразить перенос объекта при каждом движении мыши
            dragObject.avatar.style.right = percent + '%';

        };

        document.onmouseup = function (e) {

            dragObject = {
                elem: null,
                avatar: null
            };
        }
    }

}());
(function () {

    // const button = document.querySelector('.articles__more'),
    //     hidden = document.querySelector('.articles__hidden'),
    //     hiddenLIst = hidden.querySelector('.articles__list'),
    //     height = hiddenLIst.offsetHeight;
    //
    // button.addEventListener('click', function (e) {
    //    e.preventDefault();
    //
    //    hidden.style.height = height+'px';
    // });


}());
(function () {

    const button = document.querySelector('.conts-map__button'),
        close = document.querySelector('.conts-map__close'),
        map = document.querySelector('.conts-map__map');

    if (button) {
        button.addEventListener('click', function (e) {
            e.preventDefault();
            map.classList.toggle('open');
        });
        close.addEventListener('click', function (e) {
            e.preventDefault();
            map.classList.remove('open');
        });
    }


}());
(function () {
    let startButton = document.querySelector('.testing-start__button'),
    startLayer = document.querySelector('.testing-start'),
    formLayer = document.querySelector('.testing-slider');

    if (startButton) {
        startButton.addEventListener('click', function (e) {
            document.querySelector('.testing').classList.add('active');
            startLayer.classList.remove('active');
            formLayer.classList.add('active');
        })
    }

}());
(function () {
    const searchBtn = document.querySelector('.search__btn'),
        searchField = document.querySelector('.search__field'),
        searchForm = document.querySelector('.search');

    if (searchBtn) {
        searchBtn.addEventListener('click', function (e) {
            e.preventDefault();
            searchField.classList.toggle('active');
            document.querySelector('.autocomplete').classList.remove('active');
        });
    }

    const searchInput = document.querySelector('.search__input'),
        autocomplite = document.querySelector('.autocomplete');

    if (searchInput) {

        searchInput.addEventListener('input', function (e) {

            if (this.value.length > 1) {

                let data = {
                    string: this.value,
                    action: 'autocomplete'
                };

                $.ajax({
                    dataType: "json",
                    type: "POST",
                    url: 'php/ajax.php',
                    data: data,
                    success: function (result) {
                        if (result.status) {
                            autocomplite.innerHTML = '';
                            autocomplite.appendChild(createAutocompleteList(result.data));
                            autocomplite.classList.add('active');
                        } else {
                            alert('Что-то пошло не так, попробуйте еще раз!!!');
                        }
                    },
                    error: function (result) {
                        alert('Что-то пошло не так, попробуйте еще раз!!!');
                    }
                });

            }
        });

        searchInput.addEventListener('keydown', function (e) {

            let list = document.querySelector('.autocomplete__list'),
                items = document.querySelectorAll('.autocomplete__item'),
                activeItem = document.querySelector('.autocomplete__item.active'),
                nextItem = '',
                prevItem = '';

            // debugger;

            if (!activeItem) {
                nextItem = document.querySelector('.autocomplete__item'),
                    prevItem = items[items.length - 1];
            } else {
                if (activeItem.nextElementSibling) {
                    nextItem = activeItem.nextElementSibling;
                } else {
                    nextItem = document.querySelector('.autocomplete__item');
                }
                if (activeItem.previousElementSibling) {
                    prevItem = activeItem.previousElementSibling;
                } else {
                    prevItem = items[items.length - 1];
                }
            }


            if (e.keyCode == 40) { //arrow down
                clearListActive(items);
                nextItem.classList.add('active');
                searchInput.value = nextItem.innerHTML;
            } else if (e.keyCode == 38) { //arrow up
                clearListActive(items);
                prevItem.classList.add('active');
                searchInput.value = prevItem.innerHTML;
            }

        })

    }

    function clearListActive(list) {
        for (let i = 0; i < list.length; i++) {
            list[i].classList.remove('active');
        }
    }

    function createAutocompleteItem(text) {
        let item = document.createElement('li');
        item.classList.add('autocomplete__item');
        item.innerText = text;

        item.addEventListener('click', function (e) {
            searchInput.value = text;
            searchForm.submit();
        });

        return item;
    }

    function createAutocompleteList(data) {
        let list = document.createElement('ul');
        list.classList.add('autocomplete__list');

        for (let i = 0; i < data.length; i++) {
            list.appendChild(createAutocompleteItem(data[i]));
        }

        return list;
    }

}());
// (function () {

const popup = document.querySelector('.popup'),
    popupClose = document.querySelector('.popup__close'),
    popupWrapper = popup.querySelector('.popup__wrapper'),
    callorderOpenAll = document.querySelectorAll('.callorderOpen'),
    promotionOpenAll = document.querySelectorAll('.promotionOpen'),
    pushOpenAll = document.querySelectorAll('.pushOpen');

if (callorderOpenAll) {
    for (let i = 0; i < callorderOpenAll.length; i++) {
        let callorderOpen = callorderOpenAll[i];

        callorderOpen.addEventListener('click', function (e) {

            let formId = this.dataset.formId || 1,
                data = {
                    action: 'callorderForm',
                    formId: formId
                };

            $.ajax({
                dataType: "json",
                type: "POST",
                url: 'php/ajax.php',
                data: data,
                success: function (result) {
                    if (result.status) {

                        popupWrapper.innerHTML = result.html;
                        popup.classList.add('active');
                        $(document.querySelector('.callorder .form')).validate(
                            {
                                rules: {
                                    name: "required",
                                    tel: "required",
                                    email: "required"
                                },
                                messages: {
                                    name: "Введите ваше Имя",
                                    tel: "Введите ваш  Телефон",
                                    email: "Введите ваш Email"
                                },

                                submitHandler: function (form) {
                                    getTimerForm();
                                },
                                invalidHandler: function (event, validator) {
                                    // debugger;
                                },
                                errorPlacement: function (error, element) {
                                    element[0].placeholder = error[0].innerText;
                                }
                            }
                        );

                    } else {
                        alert('Что-то пошло не так, попробуйте еще раз!!!');
                    }
                },
                error: function (result) {
                    alert('Что-то пошло не так, попробуйте еще раз!!!');
                }
            });
        });
    }
}

if (promotionOpenAll) {
    for (let i = 0; i < promotionOpenAll.length; i++) {
        let promotionOpen = promotionOpenAll[i];

        promotionOpen.addEventListener('click', function (e) {

            let data = {
                action: 'promotionForm'
            };

            $.ajax({
                dataType: "json",
                type: "POST",
                url: 'php/ajax.php',
                data: data,
                success: function (result) {
                    if (result.status) {
                        popupWrapper.innerHTML = result.html;
                        popup.classList.add('active');
                        $(document.querySelector('.promotion .form')).validate(
                            {
                                rules: {
                                    tel: "required",
                                    email: "required"
                                },
                                messages: {
                                    tel: "Введите ваш  Телефон",
                                    email: "Введите ваш Email"
                                },

                                submitHandler: function (form) {
                                    getTimerForm();
                                },
                                invalidHandler: function (event, validator) {
                                    // debugger;
                                },
                                errorPlacement: function (error, element) {
                                    element[0].placeholder = error[0].innerText;
                                }
                            }
                        );

                    } else {
                        alert('Что-то пошло не так, попробуйте еще раз!!!');
                    }
                },
                error: function (result) {
                    alert('Что-то пошло не так, попробуйте еще раз!!!');
                }
            });
        });
    }
}

if (pushOpenAll) {
    for (let i = 0; i < pushOpenAll.length; i++) {
        let pushOpen = pushOpenAll[i];

        pushOpen.addEventListener('click', function (e) {
            e.preventDefault();
            let data = $(this).closest('form').serialize();

            $.ajax({
                dataType: "json",
                type: "POST",
                url: 'php/ajax.php',
                data: data,
                success: function (result) {
                    if (result.status) {

                        popupWrapper.innerHTML = result.html;
                        popup.classList.add('active');
                        $(document.querySelector('.callorder .form')).validate(
                            {
                                rules: {
                                    name: "required",
                                    tel: "required",
                                    email: "required"
                                },
                                messages: {
                                    name: "Введите ваше Имя",
                                    tel: "Введите ваш  Телефон",
                                    email: "Введите ваш Email"
                                },

                                submitHandler: function (form) {
                                    getTimerForm();
                                },
                                invalidHandler: function (event, validator) {
                                    // debugger;
                                },
                                errorPlacement: function (error, element) {
                                    element[0].placeholder = error[0].innerText;
                                }
                            }
                        );

                    } else {
                        alert('Что-то пошло не так, попробуйте еще раз!!!');
                    }
                },
                error: function (result) {
                    alert('Что-то пошло не так, попробуйте еще раз!!!');
                }
            });
        });
    }
}

function getTimerForm(formId) {

    formId = formId || 1;

    let data = {
        formId: formId,
        action: 'timerForm'
    };

    $.ajax({
        dataType: "json",
        type: "POST",
        url: 'php/ajax.php',
        data: data,
        success: function (result) {
            if (result.status) {

                popupWrapper.innerHTML = result.html;
                popup.classList.add('active');

                let timer = new Timer({
                    endTime: result.endTime,
                    timer: document.querySelector('.timer')
                }).init();

            } else {
                alert('Что-то пошло не так, попробуйте еще раз!!!');
            }
        },
        error: function (result) {
            alert('Что-то пошло не так, попробуйте еще раз!!!');
        }
    });
}

popup.addEventListener('click', function (e) {
    if (e.target.classList.contains('popup__wrapper') || e.target.classList.contains('popup__close-img')) {
        popup.classList.remove('active');
    }
});

const tarifs = document.querySelectorAll('.host-tarifs__item');

if (tarifs) {
    for (let i = 0; i < tarifs.length; i++) {

        tarifs[i].addEventListener('click', function (e) {
            e.preventDefault();


            let data = {
                id: this.dataset.id,
                name: this.dataset.name,
                src: this.dataset.src,
                action: 'tarifForm'
            };

            $.ajax({
                dataType: "json",
                type: "POST",
                url: 'php/ajax.php',
                data: data,
                success: function (result) {
                    if (result.status) {
                        popupWrapper.innerHTML = result.html;
                        popup.classList.add('active');

                        let button = popup.querySelector('.hosting__button');

                        button.addEventListener('click', function (e) {
                            getTimerForm();
                        });


                    } else {
                        alert('Что-то пошло не так, попробуйте еще раз!!!');
                    }
                },
                error: function (result) {
                    alert('Что-то пошло не так, попробуйте еще раз!!!');
                }
            });
        })
    }
}


// }());
$('.form').each(function (indx, elem) {
    $(elem).validate(
        {
            rules: {
                name: "required",
                tel: "required",
                email: "required"
            },
            messages: {
                name: "Введите ваше Имя",
                tel: "Введите ваш  Телефон",
                email: "Введите ваш Email"
            },

            submitHandler: function (form) {
                getTimerForm();
            },
            invalidHandler: function (event, validator) {
                // debugger;
            },
            errorPlacement: function (error, element) {
                element[0].placeholder = error[0].innerText;
                // debugger;
            }
        }
    );
});

$('.calc').validate(
    {
        rules: {
            name: "required",
            tel: "required",
            email: "required"
        },
        messages: {
            name: "Введите ваше Имя",
            tel: "Введите ваш  Телефон",
            email: "Введите ваш Email"
        },

        submitHandler: function (form) {
            getTimerForm();
        },
        invalidHandler: function (event, validator) {
            // debugger;
        },
        errorPlacement: function (error, element) {
            element[0].placeholder = error[0].innerText;
            // debugger;
        }
    }
);

let smmForm = $('.smm-calc__form form');

if (smmForm.length > 0) {
    smmForm.validate().destroy();
    smmForm.validate(
        {
            rules: {
                name: "required",
                tel: "required"
            },
            messages: {
                name: "Введите ваше Имя",
                tel: "Введите ваш  Телефон"
            },

            submitHandler: function (form) {
                getTimerForm();
            },
            invalidHandler: function (event, validator) {
                // debugger;
            },
            errorPlacement: function (error, element) {
                element[0].placeholder = error[0].innerText;
                // debugger;
            }
        }
    );
}

let siteForm = $('.site-cost__form');

if (siteForm.length > 0) {
    siteForm.validate().destroy();
    siteForm.validate(
        {
            rules: {
                name: "required",
                tel: "required"
            },
            messages: {
                name: "Введите ваше Имя",
                tel: "Введите ваш  Телефон"
            },

            submitHandler: function (form) {
                getTimerForm();
            },
            invalidHandler: function (event, validator) {
                // debugger;
            },
            errorPlacement: function (error, element) {
                element[0].placeholder = error[0].innerText;
                // debugger;
            }
        }
    );
}

let testForm = $('.testing__form');

if (testForm.length > 0) {

    $('.testing__radio').on('click', function (e) {
        let $this = $(this),
            slide = $this.closest('.testing__slide'),
            nextButton = slide.find('.testing__slide-next'),
            submitButton = slide.find('.testing__slide-submit');
        nextButton.removeClass('disabled');
        submitButton.removeClass('disabled');
    });

    testForm.validate().destroy();
    testForm.validate(
        {
            rules: {
                name: "required",
                tel: "required"
            },
            messages: {
                name: "Введите ваше Имя",
                tel: "Введите ваш  Телефон"
            },

            submitHandler: function (form) {

                let data = $(form).serialize();

                $.ajax({
                    dataType: "json",
                    type: "POST",
                    url: 'php/ajax.php',
                    data: data,
                    success: function (result) {
                        if (result.status) {
                            popupWrapper.innerHTML = result.html;
                            popup.classList.add('active');
                            $('.testing__form2').validate(
                                {
                                    rules: {
                                        email: "required"
                                    },
                                    messages: {
                                        email: "Введите ваш Email"
                                    },

                                    submitHandler: function (form) {
                                        getTimerForm();
                                    },
                                    invalidHandler: function (event, validator) {
                                        // debugger;
                                    },
                                    errorPlacement: function (error, element) {
                                        element[0].placeholder = error[0].innerText;
                                    }
                                }
                            );

                        } else {
                            alert('Что-то пошло не так, попробуйте еще раз!!!');
                        }
                    },
                    error: function (result) {
                        alert('Что-то пошло не так, попробуйте еще раз!!!');
                    }
                });
            },
            invalidHandler: function (event, validator) {
                // debugger;
            },
            errorPlacement: function (error, element) {
                element[0].placeholder = error[0].innerText;
                // debugger;
            }
        }
    );

}




function Timer(settings) {
    this.endTime = settings.endTime;
    this.timer = settings.timer;
    this.total = '';
    this.timer = {
        hours: {
            wrap: {
                ten: this.timer.querySelector('.timer__hour-ten .timer__wrap'),
                unit: this.timer.querySelector('.timer__hour-unit .timer__wrap')
            }
        },
        minutes: {
            wrap: {
                ten: this.timer.querySelector('.timer__minute-ten .timer__wrap'),
                unit: this.timer.querySelector('.timer__minute-unit .timer__wrap')
            }
        },
        seconds: {
            wrap: {
                ten: this.timer.querySelector('.timer__second-ten .timer__wrap'),
                unit: this.timer.querySelector('.timer__second-unit .timer__wrap')
            }
        }
    };

    let that = this;

    function getTimeRemaining() {
        let t = Date.parse(that.endTime) - Date.parse(new Date());
        let seconds = formatNumber(Math.floor((t / 1000) % 60)),
            minutes = formatNumber(Math.floor((t / 1000 / 60) % 60)),
            hours = formatNumber(Math.floor((t / (1000 * 60 * 60)) % 24));

        that.total = t;

        that.timer.seconds.time = {
            ten: parseInt(seconds.charAt(0)),
            unit: parseInt(seconds.charAt(1))
        };
        that.timer.minutes.time = {
            ten: parseInt(minutes.charAt(0)),
            unit: parseInt(minutes.charAt(1))
        };
        that.timer.hours.time = {
            ten: parseInt(hours.charAt(0)),
            unit: parseInt(hours.charAt(1))
        };
    }

    function formatNumber(num) {
        return new Intl.NumberFormat('ru-Ru', {minimumIntegerDigits: 2}).format(num)
    }

    function setTimer() {
        for(let key in that.timer) {
            let item = that.timer[key];

            item.wrap.ten.style.transform = 'translate3d(0,' + (item.time.ten*-100) + '%,0)';
            item.wrap.unit.style.transform = 'translate3d(0,' + (item.time.unit*-100) + '%,0)';
        }
    }

    this.init = function (e) {
        getTimeRemaining();
        setTimer();

        var timeInterval = setInterval(function(){
            getTimeRemaining(that.endTime);
            setTimer();
            if(that.total<=0){
                clearInterval(timeInterval);
            }
        },1000);
    }
}
(function () {

    let confirm = document.querySelector('.banner-send__confirm');

    $('.banner-send__form').validate(
        {
            rules: {
                email: "required"
            },
            messages: {
                email: "Введите ваш Email"
            },
            submitHandler: function (form) {
                typeConfirmText('Ожидайте новостей на указанную почту');
            },
            invalidHandler: function (event, validator) {
                // debugger;
            },
            errorPlacement: function (error, element) {
                element[0].placeholder = error[0].innerText;
            }
        }
    );

    function typeConfirmText(text) {
        let textArr = text.split(''),
            count = 1;

        let confirmInterval = setInterval(function () {
            let symbols = text.slice(0,count);

            if (count<textArr.length+1) {
                confirm.innerText = symbols;
                count++;
            } else {
                clearInterval(confirmInterval);
            }

        }, 200)


    }


}());
window.onload = function () {
    // initialize swiper when document ready
    let swiperReviews = new Swiper('.rev__container', {
        // Optional parameters
        direction: 'vertical',
        loop: true,
        speed: 300,
        slidesPerView: 3,
        spaceBetween: 8,
        initialSlide: 1,
        centeredSlides: true,
        slideToClickedSlide: true,
        grabCursor: true,
        on: {
            slideChange: function () {
                let index = this.activeIndex;


                for (let i = 0; i < this.slides.length; i++) {
                    this.slides[i].classList.add('inactive');
                }

                this.slides[index].classList.remove('inactive');

            },
        }
    });

    let devSwiper = new Swiper('.site-dev__container', {
        // Optional parameters
        direction: 'horizontal',
        loop: true,
        // Navigation arrows
        navigation: {
            nextEl: '.site-dev__next',
            prevEl: '.site-dev__prev',
        },
        on: {
            init: function () {
                setDevDesc(this.slides[this.activeIndex]);
            },
            slideChange: function (e) {
                setDevDesc(this.slides[this.activeIndex]);
            }
        }


    });

    function setDevDesc (slide) {
        let logoObj = document.querySelector('.site-dev__img'),
            descObj = document.querySelectorAll('.site-dev__desc-item')[0].querySelector('.site-dev__desc-val'),
            goalObj = document.querySelectorAll('.site-dev__desc-item')[1].querySelector('.site-dev__desc-val'),
            logo = slide.dataset.logo,
            desc = slide.dataset.desc,
            goal = slide.dataset.goal;

        logoObj.src = logo;
        descObj.innerText = desc;
        goalObj.innerText = goal;
    }

    let seoCatsSwiper = new Swiper('.slider__container', {
        // Optional parameters
        direction: 'horizontal',
        slidesPerView: 3,
        spaceBetween: 2,
        grabCursor: true,
        scrollbar: {
            el: '.slider__scrollbar .swiper-scrollbar',
            dragSize: 'auto'
        },
    });

    let slider2Swiper = new Swiper('.slider2__container', {
        // Optional parameters
        direction: 'horizontal',
        slidesPerView: 3,
        spaceBetween: 2,
        grabCursor: true,
        scrollbar: {
            el: '.slider2__scrollbar .swiper-scrollbar',
            dragSize: 'auto'
        },
    });

    let portSliderSwiper = new Swiper('.port-slider__container', {
        // Optional parameters
        direction: 'horizontal',
        slidesPerView: 'auto',
        loop: true,
        spaceBetween: 20,
        pagination: {
            el: '.port-slider__pagination',
            type: 'fraction',
            renderFraction: function (currentClass, totalClass) {
                return '<span class="' + currentClass + '"></span>' +
                    '<span class="swiper-pagination-seporator"></span>' +
                    '<span class="' + totalClass + '"></span>';
            }
        },

        navigation: {
            nextEl: '.port-slider__next',
            prevEl: '.port-slider__prev',
        },
    });

    let articleSwiper = new Swiper('.art-desc__swiper', {
        // Optional parameters
        direction: 'horizontal',
        slidesPerView: 1,
        loop: true,
        navigation: {
            nextEl: '.art-desc__next',
            prevEl: '.art-desc__prev',
        }
    });
    let textSwiper = new Swiper('.text-desc__swiper', {
        // Optional parameters
        direction: 'horizontal',
        slidesPerView: 1,
        loop: true,
        navigation: {
            nextEl: '.text-desc__next',
            prevEl: '.text-desc__prev',
        }
    });

    let testingSwiper = new Swiper('.testing__swiper', {
        // Optional parameters
        direction: 'horizontal',
        slidesPerView: 1,
        simulateTouch: false,
        navigation: {
            nextEl: '.testing__slide-next',
            prevEl: '.testing__slide-prev',
        },
        pagination: {
            el: '.testing__pag .swiper-pagination',
            type: 'progressbar',
        },
        on: {
            init: function () {
                let activeIndex = this.activeIndex + 1,
                    allSlides = this.slides.length,
                    percents = document.querySelector('.testing__pag-percents');

                percents.innerHTML = (activeIndex / allSlides) * 100 + ' %';
                // debugger;
                // console.log('swiper initialized');
            },
            slideChange: function () {
                let activeIndex = this.activeIndex + 1,
                    allSlides = this.slides.length,
                    percents = document.querySelector('.testing__pag-percents');

                percents.innerHTML = Math.round((activeIndex / allSlides) * 100) + ' %';
            }
        },
    });
};

//# sourceMappingURL=main.min.js.map